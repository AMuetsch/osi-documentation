

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>OSI File Format &mdash; Open Simulation Interface v3.1.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/collapsible-lists/js/CollapsibleLists.compressed.js"></script>
        <script src="../../_static/collapsible-lists/js/apply-collapsible-lists.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/collapsible-lists/css/tree_view.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Coordinate systems and reference points" href="coordinatesystem.html" />
    <link rel="prev" title="Windows" href="windows.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Open Simulation Interface
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Open Simulation Interface:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../README.html">Open Simulation Interface (OSI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="description.html">General description</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">OSI File Format</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#formats">Formats</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#osi">*.osi</a></li>
<li class="toctree-l3"><a class="reference internal" href="#txt">*.txt</a></li>
<li class="toctree-l3"><a class="reference internal" href="#txth">*.txth</a></li>
<li class="toctree-l3"><a class="reference internal" href="#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#trace-file-naming-convention">Trace file naming convention</a></li>
<li class="toctree-l2"><a class="reference internal" href="#generate-osi-traces">Generate OSI traces</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="coordinatesystem.html">Coordinate systems and reference points</a></li>
<li class="toctree-l1"><a class="reference internal" href="interfaceconventions.html">Interface Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="commenting.html">Commenting</a></li>
<li class="toctree-l1"><a class="reference internal" href="versioning.html">Versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="releases.html">Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="howtocontribute.html">Contributors’ Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../library_root.html">OSI Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">OSI Validator:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../osi-validation/README.html">OSI Validator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../osi-validation/doc/description.html">General description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../osi-validation/doc/howtocontribute.html">Contributors’ Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../osi-validation/doc/osivalidator.html">Validator Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">OSI Visualizer:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../osi-visualizer/README.html">OSI Visualizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../osi-visualizer/doc/panels.html">Panels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../osi-visualizer/doc/nvidia-docker.html">Nvidia Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../osi-visualizer/doc/howtocontribute.html">Contributors’ Guidelines</a></li>
</ul>
<p class="caption"><span class="caption-text">OSI Sensor Model Packaging:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../osi-sensor-model-packaging/README.html">OSI Sensor Model Packaging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../osi-sensor-model-packaging/doc/specification.html">OSI Sensor Model Packaging Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../osi-sensor-model-packaging/doc/examples.html">Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Proto2Cpp:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../proto2cpp/README.html">Doxygen filter for Google Protocol Buffers .proto files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../proto2cpp/README.html#version-history">Version history</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../proto2cpp/README.html#copyright">Copyright</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Open Simulation Interface</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>OSI File Format</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/open-simulation-interface/doc/fileformat.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="osi-file-format">
<h1>OSI File Format<a class="headerlink" href="#osi-file-format" title="Permalink to this headline">¶</a></h1>
<div class="section" id="formats">
<h2>Formats<a class="headerlink" href="#formats" title="Permalink to this headline">¶</a></h2>
<div class="section" id="osi">
<h3>*.osi<a class="headerlink" href="#osi" title="Permalink to this headline">¶</a></h3>
<p>To save multiple serialized OSI messages into one trace file we use the length of each OSI message and save it before the actual OSI message.
The length is represented by the first four bytes which are a little endian unsigned int that represents the length of the followed message, not including the integer itself.</p>
</div>
<div class="section" id="txt">
<h3>*.txt<a class="headerlink" href="#txt" title="Permalink to this headline">¶</a></h3>
<p>If you happen to have a trace file which uses <code class="docutils literal notranslate"><span class="pre">$$__$$</span></code> separation you can convert it to the official OSI trace file by running:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3 txt2osi.py -d trace.txt
</pre></div>
</div>
</div>
<div class="section" id="txth">
<h3>*.txth<a class="headerlink" href="#txth" title="Permalink to this headline">¶</a></h3>
<p>To read to content of a serialized txt/osi trace file we also provide a converter <code class="docutils literal notranslate"><span class="pre">osi2read.py</span></code>.
See the usage below:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3 osi2read.py -d trace.osi -o readable_trace
python3 osi2read.py -d trace.txt -f separated -o readable_trace
</pre></div>
</div>
<p>which outputs a <code class="docutils literal notranslate"><span class="pre">readable_trace.txth</span></code> which can be opened by any text editor.</p>
</div>
<div class="section" id="summary">
<h3>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h3>
<p>In summary we have currently three types of formats:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">*.osi</span></code> trace files which are length separated.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">*.txt</span></code> trace files which are <code class="docutils literal notranslate"><span class="pre">$$__$$</span></code> separated.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">*.txth</span></code> files which are human readable trace files for just plausibility checks.</p></li>
</ol>
</div>
</div>
<div class="section" id="trace-file-naming-convention">
<h2>Trace file naming convention<a class="headerlink" href="#trace-file-naming-convention" title="Permalink to this headline">¶</a></h2>
<p>As best practice we recommend to name the trace files in the following format:</p>
<div class="highlight-txt notranslate"><div class="highlight"><pre><span></span>&lt;type&gt;_&lt;osi-version&gt;_&lt;protobuf-version&gt;_&lt;frame-number&gt;_&lt;custom-trace-name&gt;.osi
</pre></div>
</div>
<p>For example a naming for a trace with the information below:</p>
<div class="highlight-txt notranslate"><div class="highlight"><pre><span></span>Type = SensorView
OSI Version= 3.1.2
Protobuf Version = 3.0.0
Number of frames = 1523
Scenario name = highway
</pre></div>
</div>
<p>would then look like this:</p>
<div class="highlight-txt notranslate"><div class="highlight"><pre><span></span>sv_312_300_1523_highway.osi
</pre></div>
</div>
<p>The type definition would only be possible for <code class="docutils literal notranslate"><span class="pre">SensorView</span> <span class="pre">=</span> <span class="pre">sv</span></code>, <code class="docutils literal notranslate"><span class="pre">SensorData</span> <span class="pre">=</span> <span class="pre">sd</span></code> and <code class="docutils literal notranslate"><span class="pre">GroundTruth</span> <span class="pre">=</span> <span class="pre">gt</span></code>.
By following this best practice users can understand the general content of a file. By comparing the information provided by the naming and the actual trace the user can check the overall validity of a trace file.</p>
</div>
<div class="section" id="generate-osi-traces">
<h2>Generate OSI traces<a class="headerlink" href="#generate-osi-traces" title="Permalink to this headline">¶</a></h2>
<p>If you want to generate a valid OSI trace file which can be used as an input for the <a class="reference external" href="https://github.com/OpenSimulationInterface/osi-validation">osi-validator</a> or the <a class="reference external" href="https://github.com/OpenSimulationInterface/osi-visualizer">osi-visualizer</a> see the example script in python below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">osi3.osi_sensorview_pb2</span> <span class="kn">import</span> <span class="n">SensorView</span>
<span class="kn">import</span> <span class="nn">struct</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Initialize SensorView&quot;&quot;&quot;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;sv_312_320_10_movingobject.osi&quot;</span><span class="p">,</span> <span class="s2">&quot;ab&quot;</span><span class="p">)</span>
    <span class="n">sensorview</span> <span class="o">=</span> <span class="n">SensorView</span><span class="p">()</span>

    <span class="n">sv_ground_truth</span> <span class="o">=</span> <span class="n">sensorview</span><span class="o">.</span><span class="n">global_ground_truth</span>
    <span class="n">sv_ground_truth</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">version_major</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">sv_ground_truth</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">version_minor</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">sv_ground_truth</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">version_patch</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">sv_ground_truth</span><span class="o">.</span><span class="n">timestamp</span><span class="o">.</span><span class="n">seconds</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">sv_ground_truth</span><span class="o">.</span><span class="n">timestamp</span><span class="o">.</span><span class="n">nanos</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">moving_object</span> <span class="o">=</span> <span class="n">sv_ground_truth</span><span class="o">.</span><span class="n">moving_object</span><span class="o">.</span><span class="n">add</span><span class="p">()</span>
    <span class="n">moving_object</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">114</span>

    <span class="c1"># Generate 10 OSI messages for 9 seconds</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>

        <span class="c1"># Increment the time</span>
        <span class="n">sv_ground_truth</span><span class="o">.</span><span class="n">timestamp</span><span class="o">.</span><span class="n">seconds</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">sv_ground_truth</span><span class="o">.</span><span class="n">timestamp</span><span class="o">.</span><span class="n">nanos</span> <span class="o">+=</span> <span class="mi">100000</span>

        <span class="n">moving_object</span><span class="o">.</span><span class="n">vehicle_classification</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="mi">2</span>

        <span class="n">moving_object</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">dimension</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">moving_object</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">dimension</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">moving_object</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">dimension</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">moving_object</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="n">i</span>
        <span class="n">moving_object</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">moving_object</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="n">moving_object</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">roll</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">moving_object</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">pitch</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">moving_object</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">yaw</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="sd">&quot;&quot;&quot;Serialize&quot;&quot;&quot;</span>
        <span class="n">bytes_buffer</span> <span class="o">=</span> <span class="n">sensorview</span><span class="o">.</span><span class="n">SerializeToString</span><span class="p">()</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">bytes_buffer</span><span class="p">))</span> <span class="o">+</span> <span class="n">bytes_buffer</span><span class="p">)</span>

    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>In the script we initialize the type we want to use for the messages. Here we use the type <code class="docutils literal notranslate"><span class="pre">SensorView</span></code>.
For the <code class="docutils literal notranslate"><span class="pre">SensorView</span></code> it is mandatory to define the version and the timestamp. After that we can add objects.
Here we add a moving object with the ID 114. For this object we generate in a for loop 10 OSI messages which all have different x values over a time span of 9 seconds.
This means the object is changing the position in the x direction through the iteration each second.
Each time we change the x value and the timestamp we append the length of the OSI message and the serialized OSI message itself to a file called <code class="docutils literal notranslate"><span class="pre">sv_312_320_10_movingobject.osi</span></code>.
After finishing the loop we now have a <code class="docutils literal notranslate"><span class="pre">sv_312_320_10_movingobject.osi</span></code> file which can be <a class="reference external" href="https://github.com/OpenSimulationInterface/osi-validation">validated</a> and <a class="reference external" href="https://github.com/OpenSimulationInterface/osi-visualizer">visualized</a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="coordinatesystem.html" class="btn btn-neutral float-right" title="Coordinate systems and reference points" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="windows.html" class="btn btn-neutral float-left" title="Windows" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Carlo van Driesten

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>